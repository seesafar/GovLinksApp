<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>توثيق الأمان – OneLink</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #050816;
      color: #f9fafb;
      padding: 24px;
      line-height: 1.8;
    }
    h1, h2, h3 {
      color: #38bdf8;
      margin-top: 1.5rem;
    }
    code {
      background: #111827;
      padding: 2px 6px;
      border-radius: 4px;
      direction: ltr;
      display: inline-block;
      font-size: 0.85rem;
    }
    pre {
      background: #020617;
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
      direction: ltr;
      font-size: 0.85rem;
    }
    hr {
      border-color: #1f2937;
      margin: 24px 0;
    }
    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #1f2937;
      font-size: 0.75rem;
      margin-left: 4px;
    }
  </style>
</head>
<body>
  <h1>توثيق الأمان لمشروع OneLink / GovLinksApp</h1>
  <p>إعداد: سفّر الغامدي – الإصدار 2025</p>
  <hr />

  <h2>1. معلومات عامة عن المشروع</h2>
  <ul>
    <li><strong>اسم المشروع:</strong> OneLink – Unified Government Links</li>
    <li><strong>المجلد الرئيسي:</strong> <code>C:\\Projects\\GovLinksApp</code></li>
    <li><strong>الهدف:</strong> تجميع أهم المنصات والخدمات الحكومية في واجهة واحدة مع طبقة أمان قوية تحمي المستخدم من الروابط غير الموثوقة.</li>
    <li><strong>التقنيات:</strong> <span class="tag">Node.js</span><span class="tag">Express</span><span class="tag">Helmet</span><span class="tag">Rate Limiting</span></li>
  </ul>

  <h2>2. الملفات والمجلدات الأمنية المهمة</h2>
  <ul>
    <li><code>server.js</code> — ملف السيرفر الرئيسي.</li>
    <li><code>security-config.js</code> — إعدادات الأمان (القائمة البيضاء، مفتاح الداشبورد، إعدادات الـ Rate Limit).</li>
    <li><code>logs/security.log</code> — سجل الأحداث الأمنية.</li>
    <li><code>assets/project-folder/services.js</code> — سكربت حماية الروابط + التنبيهات.</li>
    <li><code>assets/project-folder/security-header.js</code> — سكربت رسائل الأمان.</li>
    <li><code>assets/project-folder/index.html</code> — الواجهة الرئيسية لـ OneLink.</li>
  </ul>

  <h2>3. طبقات الأمان المطبقة</h2>

  <h3>3.1 حماية الهيدرات (Security Headers)</h3>
  <p>باستخدام <code>helmet</code> لتفعيل:</p>
  <ul>
    <li>HSTS</li>
    <li>XSS Protection</li>
    <li>No Sniff</li>
    <li>Frameguard</li>
    <li>Content-Security-Policy (مخصصة)</li>
  </ul>

  <h3>3.2 Rate Limiting — منع الإغراق</h3>
  <p>تحديد عدد الطلبات المسموح بها لكل IP خلال فترة زمنية، وتسجيل الحدث:</p>
  <pre><code>RATE_LIMIT_BLOCK</code></pre>

  <h3>3.3 نظام تسجيل الأحداث الأمنية</h3>
  <p>تسجيل الوقت، الـ IP، المسار، نوع الحدث، و UserAgent داخل:</p>
  <pre><code>logs/security.log</code></pre>

  <h3>3.4 نظام إعادة التوجيه الآمن (Smart Redirect)</h3>
  <p>كل رابط يمر عبر API:</p>
  <pre><code>POST /api/safe-redirect</code></pre>
  <p>ويتم فحصه مقابل قائمة الدومينات الموثوقة (Whitelist). عند السماح:</p>
  <pre><code>ALLOWED_REDIRECT</code></pre>
  <p>وعند المنع:</p>
  <pre><code>BLOCKED_REDIRECT</code></pre>

  <h3>3.5 حماية الواجهة الأمامية</h3>
  <ul>
    <li>عرض تنبيه أمني للمستخدم عند محاولة فتح رابط غير موثوق.</li>
    <li>إرسال بلاغ للسيرفر عبر <code>/api/security/report-incident</code>.</li>
    <li>ربط الأزرار عبر <code>data-service-url</code> لتمرير الروابط عبر <code>safeRedirect()</code>.</li>
  </ul>

  <h3>3.6 لوحة التحكم الأمنية (Security Dashboard)</h3>
  <p>متاحة عبر الرابط (مع مفتاح سري):</p>
  <pre><code>http://localhost:3000/admin-security?key=OneLink_Admin_2025_OnlySafar</code></pre>
  <p>وتعرض:</p>
  <ul>
    <li>الوقت</li>
    <li>IP</li>
    <li>نوع الحدث</li>
    <li>المسار</li>
    <li>التفاصيل</li>
  </ul>

  <h2>4. سيناريوهات الاختبار</h2>

  <h3>4.1 اختبار رابط خبيث</h3>
  <pre><code>safeRedirect("https://evil-hacker.com");</code></pre>
  <p>النتيجة: تحذير + منع التوجيه + تسجيل <code>BLOCKED_REDIRECT</code>.</p>

  <h3>4.2 اختبار رابط موثوق</h3>
  <pre><code>safeRedirect("https://www.absher.sa");</code></pre>
  <p>النتيجة: لا تحذير + فتح الموقع بنجاح.</p>

  <h3>4.3 اختبار Rate Limiting</h3>
  <p>الإرسال المتكرر يؤدي إلى:</p>
  <pre><code>تم إيقاف طلباتك مؤقتاً بسبب كثرة المحاولات.</code></pre>
  <p>وتسجيل <code>RATE_LIMIT_BLOCK</code>.</p>

  <h2>5. تشغيل المشروع</h2>
  <pre><code>cd C:\\Projects\\GovLinksApp
node server.js</code></pre>
  <p>الواجهة:</p>
  <pre><code>http://localhost:3000/</code></pre>
  <p>لوحة الأمن:</p>
  <pre><code>http://localhost:3000/admin-security?key=OneLink_Admin_2025_OnlySafar</code></pre>

  <h2>6. أفضل الممارسات المستقبلية</h2>
  <ul>
    <li>إخفاء ملفات الإعدادات الحساسة عن المستودعات العامة.</li>
    <li>تغيير مفتاح الداشبورد عند الرفع للإنتاج.</li>
    <li>يمكن إضافة تنبيهات (Email / Telegram) عند حدوث هجمات متكررة.</li>
  </ul>

  <h2>7. ملخص</h2>
  <p>
    مشروع OneLink مجهز الآن بطبقة أمان متكاملة:
    Back-end + Front-end، مع Dashboard لمراقبة الهجمات
    ونظام ذكي للتعامل مع الروابط الموثوقة والمشبوهة.
  </p>

  <hr />
  <p><strong>إعداد:</strong> سفّر الغامدي – 2025</p>
</body>
</html>
